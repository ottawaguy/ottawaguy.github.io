<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hockey Lineup Tool</title>
    <style>
        body {
            background-color: black;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        header {
            text-align: left;
            padding: 1em;
            width: 100%;
        }

        header img {
            max-width: 100px;
        }

        main {
            padding: 1em;
            width: 100%;
        }

        section {
            margin-bottom: 2em;
            width: 100%;
        }

        #roster, #lineup {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        #player-list, .line, .pair, .spot {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .player-box {
            background-color: yellow;
            border-radius: 5px;
            padding: 0.5em;
            cursor: grab;
            text-align: center;
        }

        .spot {
            width: 100px;
            height: 100px;
            border: 2px dashed white;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: white;
            color: black;
            text-align: center;
        }

        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 0.5em 1em;
            cursor: pointer;
            border-radius: 5px;
            margin-top: 10px;
        }

        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <header>
        <img src="cumberland-dukes-logo.png" alt="Cumberland Dukes Hockey Logo">
        <h1>Hockey Lineup Tool</h1>
    </header>
    <main>
        <section id="roster">
            <h2>Roster</h2>
            <input type="text" id="player-name" placeholder="Enter player name">
            <button onclick="addPlayer()">Add Player</button>
            <div id="player-list"></div>
        </section>
        <section id="lineup">
            <h2>Lineup</h2>
            <div id="forwards">
                <h3>Forwards</h3>
                <div class="line" id="line1" ondrop="drop(event)" ondragover="allowDrop(event)">
                    <div class="spot" id="F1"></div>
                    <div class="spot" id="F2"></div>
                    <div class="spot" id="F3"></div>
                </div>
                <div class="line" id="line2" ondrop="drop(event)" ondragover="allowDrop(event)">
                    <div class="spot" id="F4"></div>
                    <div class="spot" id="F5"></div>
                    <div class="spot" id="F6"></div>
                </div>
                <div class="line" id="line3" ondrop="drop(event)" ondragover="allowDrop(event)">
                    <div class="spot" id="F7"></div>
                    <div class="spot" id="F8"></div>
                    <div class="spot" id="F9"></div>
                </div>
            </div>
            <div id="defensemen">
                <h3>Defensemen</h3>
                <div class="pair" id="pair1" ondrop="drop(event)" ondragover="allowDrop(event)">
                    <div class="spot" id="D1"></div>
                    <div class="spot" id="D2"></div>
                </div>
                <div class="pair" id="pair2" ondrop="drop(event)" ondragover="allowDrop(event)">
                    <div class="spot" id="D3"></div>
                    <div class="spot" id="D4"></div>
                </div>
                <div class="pair" id="pair3" ondrop="drop(event)" ondragover="allowDrop(event)">
                    <div class="spot" id="D5"></div>
                    <div class="spot" id="D6"></div>
                </div>
            </div>
            <div id="goalie">
                <h3>Goalie</h3>
                <div class="spot" id="goalie-spot" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            </div>
        </section>
        <button onclick="undoAction()">Undo</button>
        <button onclick="clearAll()">Clear</button>
    </main>
    <script>
        let players = [];
        let lineup = {
            forwards: [[], [], []],
            defensemen: [[], [], []],
            goalie: []
        };
        let actionHistory = [];

        function addPlayer() {
            const playerName = document.getElementById('player-name').value.trim();
            if (playerName && !players.includes(playerName)) {
                const playerBox = document.createElement('div');
                playerBox.className = 'player-box';
                playerBox.textContent = playerName;
                playerBox.draggable = true;
                playerBox.addEventListener('dragstart', dragStart);
                playerBox.addEventListener('touchstart', longPress);
                document.getElementById('player-list').appendChild(playerBox);
                players.push(playerName);
                actionHistory.push({ type: 'add', player: playerName });
                document.getElementById('player-name').value = '';
            }
        }

        function dragStart(event) {
            event.dataTransfer.setData('text/plain', event.target.textContent);
            event.dataTransfer.effectAllowed = 'move';
        }

        function allowDrop(event) {
            event.preventDefault();
        }

        function drop(event) {
            event.preventDefault();
            const playerName = event.dataTransfer.getData('text/plain');
            const target = event.target;
            if (target.classList.contains('spot') && target.children.length === 0) {
                const playerBox = document.createElement('div');
                playerBox.className = 'player-box';
                playerBox.textContent = playerName;
                playerBox.draggable = true;
                playerBox.addEventListener('dragstart', dragStart);
                playerBox.addEventListener('touchstart', longPress);
                target.appendChild(playerBox);
                actionHistory.push({ type: 'move', player: playerName, to: target.id });
                removePlayerFromRoster(playerName);
            } else if (target.classList.contains('spot') && target.children.length > 0) {
                const existingPlayerBox = target.querySelector('.player-box');
                const existingPlayerName = existingPlayerBox.textContent;
                existingPlayerBox.remove();
                const playerBox = document.createElement('div');
                playerBox.className = 'player-box';
                playerBox.textContent = playerName;
                playerBox.draggable = true;
                playerBox.addEventListener('dragstart', dragStart);
                playerBox.addEventListener('touchstart', longPress);
                target.appendChild(playerBox);
                actionHistory.push({ type: 'move', player: playerName, to: target.id });
                actionHistory.push({ type: 'move', player: existingPlayerName, to: 'roster' });
                addPlayerToRoster(existingPlayerName);
            }
        }

        function longPress(event) {
            let pressTimer;
            event.target.addEventListener('touchstart', function startPress(e) {
                pressTimer = setTimeout(function () {
                    const playerName = e.target.textContent;
                    e.target.remove();
                    players = players.filter(p => p !== playerName);
                    actionHistory.push({ type: 'delete', player: playerName });
                }, 1000);
            });

            event.target.addEventListener('touchend', function cancelPress() {
                clearTimeout(pressTimer);
            });
        }

        function removePlayerFromRoster(playerName) {
            const playerBox = document.querySelector(`.player-box:contains(${playerName})`);
            if (playerBox) {
                playerBox.remove();
                players = players.filter(p => p !== playerName);
            }
        }

        function addPlayerToRoster(playerName) {
            const playerBox = document.createElement('div');
            playerBox.className = 'player-box';
            playerBox.textContent = playerName;
            playerBox.draggable = true;
            playerBox.addEventListener('dragstart', dragStart);
            playerBox.addEventListener('touchstart', longPress);
            document.getElementById('player-list').appendChild(playerBox);
            players.push(playerName);
        }

        function undoAction() {
            if (actionHistory.length > 0) {
                const lastAction = actionHistory.pop();
                if (lastAction.type === 'add') {
                    const playerBox = document.querySelector(`.player-box:contains(${lastAction.player})`);
                    playerBox.remove();
                    players = players.filter(p => p !== lastAction.player);
                } else if (lastAction.type === 'move') {
                    const playerBox = document.querySelector(`.player-box:contains(${lastAction.player})`);
                    playerBox.remove();
                    const playerIndex = players.indexOf(lastAction.player);
                    if (playerIndex !== -1) {
                        players.splice(playerIndex, 1);
                    }
                    const rosterPlayerBox = document.createElement('div');
                    rosterPlayerBox.className = 'player-box';
                    rosterPlayerBox.textContent = lastAction.player;
                    rosterPlayerBox.draggable = true;
                    rosterPlayerBox.addEventListener('dragstart', dragStart);
                    rosterPlayerBox.addEventListener('touchstart', longPress);
                    document.getElementById('player-list').appendChild(rosterPlayerBox);
                    players.push(lastAction.player);
                } else if (lastAction.type === 'delete') {
                    const playerBox = document.createElement('div');
                    playerBox.className = 'player-box';
                    playerBox.textContent = lastAction.player;
                    playerBox.draggable = true;
                    playerBox.addEventListener('dragstart', dragStart);
                    playerBox.addEventListener('touchstart', longPress);
                    document.getElementById('player-list').appendChild(playerBox);
                    players.push(lastAction.player);
                }
            }
        }

        function clearAll() {
            document.getElementById('player-list').innerHTML = '';
            document.querySelectorAll('.spot').forEach(spot => spot.innerHTML = '');
            players = [];
            lineup = {
                forwards: [[], [], []],
                defensemen: [[], [], []],
                goalie: []
            };
            actionHistory = [];
        }
    </script>
</body>
</html>
